
@Bean
	public Job mainJob(JobRepository jobRepository,
			@Qualifier("batchTransactionManager") PlatformTransactionManager batchTransactionManager) throws Exception {
		JobBuilder jobBuilder = new JobBuilder("mainJob", jobRepository);
		return jobBuilder.incrementer(new RunIdIncrementer())
				.start(locationDataFromDB(jobRepository, batchTransactionManager)).on("COMPELTED").to(exportHSDataFromDB(jobRepository, batchTransactionManager))
				.from(exportHSDataFromDB(jobRepository, batchTransactionManager)).on("COMPLETED").to(qualificationEntityDataFromDB(jobRepository, batchTransactionManager))
				.from(qualificationEntityDataFromDB(jobRepository, batchTransactionManager)).on("COMPLETED").to(practitionerDataFromDB(jobRepository, batchTransactionManager))
				.from(practitionerDataFromDB(jobRepository, batchTransactionManager)).on("COMPLETED").to(exportOrganisationDataFromDB(jobRepository, batchTransactionManager))
				.from(exportOrganisationDataFromDB(jobRepository, batchTransactionManager)).on("COMPLETED").to(exportOAFDataFromDB(jobRepository, batchTransactionManager))
				.from(exportOAFDataFromDB(jobRepository, batchTransactionManager)).on("COMPLETED").to(exportPRDataFromDB(jobRepository, batchTransactionManager))
				.from(exportPRDataFromDB(jobRepository, batchTransactionManager)).end().build();
		
@SuppressWarnings("unchecked")
	@Bean
	public Step qualificationEntityDataFromDB(JobRepository jobRepository,
			PlatformTransactionManager batchTransactionManager) throws Exception {
		return new StepBuilder("qualificationEntityDataFromDB", jobRepository)
				.<QualificationEntity, Organization>chunk(chunksize, batchTransactionManager)
				.reader(pdtQualificationEntityReader)
				.processor(pdtQualificationEntityProcessor.asyncQualificationEntityItemProcessor())
				.writer(pdtQualificationEntityWriter.asyncQualificationEntityItemWriter()).faultTolerant()
				.skip(Exception.class).skipLimit(Integer.MAX_VALUE).taskExecutor(pdtExecuter)
				// .listener(skipListener())
				.build();
	}
